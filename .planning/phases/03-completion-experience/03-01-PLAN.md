---
phase: 03-completion-experience
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/App.tsx
  - src/App.css
autonomous: true

must_haves:
  truths:
    - "When timer reaches 00:00, the display turns green"
    - "Rick Astley image appears when timer completes"
    - "A 30-second reset countdown displays after timer completion"
    - "After reset countdown ends, next session auto-starts with mode toggled"
    - "Session counter shows number of completed timers"
  artifacts:
    - path: "src/App.tsx"
      provides: "Timer completion logic, reset countdown, session tracking"
      contains: "isComplete"
    - path: "src/App.css"
      provides: "Green completion styling"
      contains: "complete"
  key_links:
    - from: "src/App.tsx"
      to: "completion state"
      via: "timeLeft reaching 0 triggers isComplete=true"
      pattern: "timeLeft.*===.*0"
    - from: "src/App.tsx"
      to: "mode toggle"
      via: "reset countdown completion toggles work/break"
      pattern: "setMode.*work.*break"
    - from: "src/App.tsx"
      to: "session counter"
      via: "completion increments sessionCount"
      pattern: "setSessionCount"
---

<objective>
Add completion experience: green state, Rick Astley celebration, reset countdown with auto-cycle, and session tracking.

Purpose: Transform the timer from a simple countdown into an entertaining demo loop that automatically cycles through work/break sessions with visual celebration feedback.

Output: A fully self-running demo timer that turns green on completion, shows Rick Astley, counts down 30 seconds, auto-starts the next session with toggled mode, and tracks completed sessions.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Phase 2 Timer Core provides:
# - Timer state (timeLeft, isRunning)
# - Timer controls (start, stop, reset)
# - Mode state (work/break) with visual differentiation
# - setInterval-based countdown logic
# Reference: .planning/phases/02-timer-core/*-SUMMARY.md (when available)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add completion state with green styling and Rick Astley</name>
  <files>
    src/App.tsx
    src/App.css
  </files>
  <action>
    Add completion detection and celebration visuals.

    In src/App.tsx:
    1. Add state: `isComplete` (boolean, starts false)
    2. In the timer useEffect, when timeLeft reaches 0:
       - Set isComplete = true
       - Set isRunning = false
    3. Add Rick Astley image element that renders when isComplete is true:
       - Use a Rick Astley image URL (e.g., https://media.giphy.com/media/Vuw9m5wXviFIQ/giphy.gif for the classic rickroll gif)
       - Or a static image: https://upload.wikimedia.org/wikipedia/en/thumb/9/9d/Rick_Astley_-_Never_Gonna_Give_You_Up.png/220px-Rick_Astley_-_Never_Gonna_Give_You_Up.png
       - Display centered below the timer
    4. Add CSS class "complete" to timer display when isComplete is true

    In src/App.css:
    1. Add .complete class with green background or text color
       - background-color: #4ade80 (tailwind green-400) or similar
       - Or color the timer digits green
    2. Style the Rick image to be appropriately sized (200-300px width)

    The completion state should be visually obvious - the entire timer area should feel "celebratory".
  </action>
  <verify>
    - Start timer, let it count down to 00:00
    - Timer display turns green when hitting zero
    - Rick Astley image/gif appears on screen
    - Timer stops running (isRunning becomes false)
  </verify>
  <done>Timer turns green at 00:00, Rick Astley appears, requirements COMP-01 and COMP-02 satisfied</done>
</task>

<task type="auto">
  <name>Task 2: Add reset countdown and auto-cycle to next session</name>
  <files>
    src/App.tsx
  </files>
  <action>
    Add a 30-second reset countdown after completion that auto-starts the next session.

    In src/App.tsx:
    1. Add state: `resetCountdown` (number, null or 0 when not active)
    2. When isComplete becomes true (in the existing useEffect or a new one):
       - Start a second countdown from 30
       - Display this countdown somewhere visible (e.g., "Next session in: 30s")
    3. Add a useEffect for the reset countdown:
       - When resetCountdown > 0 and isComplete is true, decrement every second
       - When resetCountdown reaches 0:
         a. Toggle mode: if mode === 'work', set to 'break'; if 'break', set to 'work'
         b. Reset timeLeft to 30 (the demo duration)
         c. Set isComplete = false
         d. Set isRunning = true (auto-start)
         e. Clear/reset resetCountdown
    4. Display the reset countdown text when isComplete is true:
       - "Next session in: {resetCountdown}s"
       - Style it to be visible but secondary to the celebration

    The flow should be:
    - Timer hits 0 -> green + Rick + "Next session in: 30s"
    - Countdown 30...29...28...
    - At 0 -> mode toggles, timer resets to 00:30, auto-starts

    This creates a self-running demo loop.
  </action>
  <verify>
    - Let timer complete (reach 00:00)
    - See "Next session in: 30s" appear
    - Watch countdown decrement each second
    - At 0: mode toggles, timer resets to 00:30, starts automatically
    - If was "Work" mode, now shows "Break" mode (or vice versa)
  </verify>
  <done>30-second reset countdown works, auto-cycles to next session with mode toggle, requirements COMP-03 and COMP-04 satisfied</done>
</task>

<task type="auto">
  <name>Task 3: Add session counter</name>
  <files>
    src/App.tsx
    src/App.css
  </files>
  <action>
    Track and display the number of completed sessions.

    In src/App.tsx:
    1. Add state: `sessionCount` (number, starts at 0)
    2. When a timer completes (in the completion logic from Task 1):
       - Increment sessionCount by 1
    3. Display session count in the UI:
       - "Sessions completed: {sessionCount}"
       - Place it in a visible but non-intrusive location (e.g., top of the app or below controls)

    In src/App.css:
    1. Style the session counter to be subtle but readable
    2. Maybe a smaller font size, muted color

    The counter should:
    - Start at 0
    - Increment each time the timer reaches 00:00
    - Persist across mode changes (work->break->work all count)
    - Reset only on page refresh (no persistence requirement)
  </action>
  <verify>
    - App shows "Sessions completed: 0" initially
    - Let timer complete -> counter shows 1
    - Let reset countdown finish, next timer complete -> counter shows 2
    - Counter persists correctly through multiple cycles
  </verify>
  <done>Session counter tracks and displays completed timers, requirement TRACK-01 satisfied</done>
</task>

</tasks>

<verification>
After all tasks complete:

1. Start the timer and let it run to 00:00
2. Verify:
   - Timer display turns green
   - Rick Astley image/gif is visible
   - "Next session in: 30s" appears and counts down
   - Session counter increments to 1
3. Wait for reset countdown to reach 0
4. Verify:
   - Mode toggles (Work -> Break or Break -> Work)
   - Timer resets to 00:30
   - Timer auto-starts without user interaction
   - Rick Astley disappears, green state clears
5. Let second timer complete
6. Verify:
   - Session counter shows 2
   - Cycle repeats correctly
7. Test manual Reset button during completion state - should clear completion and return to normal
</verification>

<success_criteria>
- [ ] Timer turns green when reaching 00:00 (COMP-01)
- [ ] Rick Astley image/gif displays on completion (COMP-02)
- [ ] 30-second reset countdown appears after completion (COMP-03)
- [ ] After reset countdown, next session auto-starts with mode toggled (COMP-04)
- [ ] Session counter displays and increments correctly (TRACK-01)
- [ ] Demo can run in a continuous loop without user interaction
- [ ] Manual controls (Reset) still work during completion state
</success_criteria>

<output>
After completion, create `.planning/phases/03-completion-experience/03-01-SUMMARY.md`
</output>
